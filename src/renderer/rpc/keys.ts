// Code generated by protoc-gen-tsrpc DO NOT EDIT.
// InputID: cb40823023a6ee47daa68e3ad43e3b183a250220
import {ipcRenderer} from 'electron'
import {randomBytes} from 'crypto'

import {
  KeyGenerateRequest,
  KeyGenerateResponse,
  KeysRequest,
  KeysResponse,
  KeyRequest,
  KeyResponse,
  KeyImportRequest,
  KeyImportResponse,
  KeyExportRequest,
  KeyExportResponse,
  KeyRemoveRequest,
  KeyRemoveResponse,
  SignRequest,
  SignResponse,
  SignFileInput,
  SignFileOutput,
  SignInput,
  SignOutput,
  VerifyRequest,
  VerifyResponse,
  VerifyFileInput,
  VerifyFileOutput,
  VerifyInput,
  VerifyOutput,
  VerifyDetachedRequest,
  VerifyDetachedResponse,
  VerifyDetachedFileInput,
  VerifyDetachedInput,
  EncryptRequest,
  EncryptResponse,
  EncryptInput,
  EncryptOutput,
  EncryptFileInput,
  EncryptFileOutput,
  DecryptRequest,
  DecryptResponse,
  DecryptInput,
  DecryptOutput,
  DecryptFileInput,
  DecryptFileOutput,
  SigchainRequest,
  SigchainResponse,
  StatementRequest,
  StatementResponse,
  StatementCreateRequest,
  StatementCreateResponse,
  StatementRevokeRequest,
  StatementRevokeResponse,
  UserRequest,
  UserResponse,
  UserSearchRequest,
  UserSearchResponse,
  UserServiceRequest,
  UserServiceResponse,
  UserSignRequest,
  UserSignResponse,
  UserAddRequest,
  UserAddResponse,
  SearchRequest,
  SearchResponse,
  SecretRequest,
  SecretResponse,
  SecretSaveRequest,
  SecretSaveResponse,
  SecretRemoveRequest,
  SecretRemoveResponse,
  SecretsRequest,
  SecretsResponse,
  ItemRequest,
  ItemResponse,
  ItemsRequest,
  ItemsResponse,
  PullRequest,
  PullResponse,
  PushRequest,
  PushResponse,
  WormholeInput,
  WormholeOutput,
  AuthSetupRequest,
  AuthSetupResponse,
  AuthVaultRequest,
  AuthVaultResponse,
  AuthUnlockRequest,
  AuthUnlockResponse,
  AuthLockRequest,
  AuthLockResponse,
  RuntimeStatusRequest,
  RuntimeStatusResponse,
  RandRequest,
  RandResponse,
  RandPasswordRequest,
  RandPasswordResponse,
  AuthProvisionRequest,
  AuthProvisionResponse,
  AuthDeprovisionRequest,
  AuthDeprovisionResponse,
  AuthProvisionsRequest,
  AuthProvisionsResponse,
  PasswordChangeRequest,
  PasswordChangeResponse,
  VaultAuthRequest,
  VaultAuthResponse,
  VaultSyncRequest,
  VaultSyncResponse,
  VaultUnsyncRequest,
  VaultUnsyncResponse,
  VaultStatusRequest,
  VaultStatusResponse,
  VaultUpdateRequest,
  VaultUpdateResponse,
  CollectionsRequest,
  CollectionsResponse,
  DocumentsRequest,
  DocumentsResponse,
  DocumentDeleteRequest,
  DocumentDeleteResponse,
  AdminSignURLRequest,
  AdminSignURLResponse,
  AdminCheckRequest,
  AdminCheckResponse,
  MessagePrepareRequest,
  MessagePrepareResponse,
  MessageCreateRequest,
  MessageCreateResponse,
  MessagesRequest,
  MessagesResponse
} from './keys.d'

const replyID = (): string => {
  return randomBytes(20).toString('hex')
}

export type ErrHandler = (err: {message: string; code: number}) => void
var errHandler: ErrHandler = (err: {message: string; code: number}) => {}
export const setErrHandler = (eh: ErrHandler) => {
  errHandler = eh
}

export const keyGenerate = (req: KeyGenerateRequest) => {
	return new Promise<KeyGenerateResponse>((resolve, reject) => {
		const reply = 'Keys.KeyGenerate-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.KeyGenerate):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.KeyGenerate) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.KeyGenerate)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'KeyGenerate', args: req, reply: reply})
	})
}

export const keys = (req: KeysRequest) => {
	return new Promise<KeysResponse>((resolve, reject) => {
		const reply = 'Keys.Keys-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Keys):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Keys) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Keys)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Keys', args: req, reply: reply})
	})
}

export const key = (req: KeyRequest) => {
	return new Promise<KeyResponse>((resolve, reject) => {
		const reply = 'Keys.Key-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Key):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Key) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Key)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Key', args: req, reply: reply})
	})
}

export const keyImport = (req: KeyImportRequest) => {
	return new Promise<KeyImportResponse>((resolve, reject) => {
		const reply = 'Keys.KeyImport-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.KeyImport):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.KeyImport) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.KeyImport)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'KeyImport', args: req, reply: reply})
	})
}

export const keyExport = (req: KeyExportRequest) => {
	return new Promise<KeyExportResponse>((resolve, reject) => {
		const reply = 'Keys.KeyExport-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.KeyExport):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.KeyExport) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.KeyExport)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'KeyExport', args: req, reply: reply})
	})
}

export const keyRemove = (req: KeyRemoveRequest) => {
	return new Promise<KeyRemoveResponse>((resolve, reject) => {
		const reply = 'Keys.KeyRemove-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.KeyRemove):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.KeyRemove) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.KeyRemove)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'KeyRemove', args: req, reply: reply})
	})
}

export const sign = (req: SignRequest) => {
	return new Promise<SignResponse>((resolve, reject) => {
		const reply = 'Keys.Sign-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Sign):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Sign) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Sign)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Sign', args: req, reply: reply})
	})
}

export type SignFileEvent = {err?: {message: string; name: string; code?: number}, res?: SignFileOutput, done: boolean}

export const signFile = (
  f: (res: SignFileEvent) => void
): ((req?: SignFileInput, end?: boolean) => void) => {
  const reply = 'Keys.SignFile-' + replyID()
  ipcRenderer.on(reply, (event, arg) => {
    if (!!arg.done || arg.err) {
      ipcRenderer.removeAllListeners(reply)
	}
	if (arg.err) {
	  console.error('RPC-stream error (Keys.SignFile):', arg.err)
      errHandler(arg.err)
    }
    if (!!arg.done) {
      console.log('RPC-stream (Keys.SignFile) done')
	}
	const res: SignFileEvent = {		
		res: arg.resp,
		err: arg.err,
		done: !!arg.done, 
	}
	f(res)
  })
  console.log('RPC-stream (Keys.SignFile)...')
  return (req?: SignFileInput, end?: boolean) => {
    ipcRenderer.send('rpc-stream', {service: 'Keys', method: 'SignFile', args: req, reply: reply, end: end})
    if (end) {
      ipcRenderer.removeAllListeners(reply)
    }
  }
}

export type SignStreamEvent = {err?: {message: string; name: string; code?: number}, res?: SignOutput, done: boolean}

export const signStream = (
  f: (res: SignStreamEvent) => void
): ((req?: SignInput, end?: boolean) => void) => {
  const reply = 'Keys.SignStream-' + replyID()
  ipcRenderer.on(reply, (event, arg) => {
    if (!!arg.done || arg.err) {
      ipcRenderer.removeAllListeners(reply)
	}
	if (arg.err) {
	  console.error('RPC-stream error (Keys.SignStream):', arg.err)
      errHandler(arg.err)
    }
    if (!!arg.done) {
      console.log('RPC-stream (Keys.SignStream) done')
	}
	const res: SignStreamEvent = {		
		res: arg.resp,
		err: arg.err,
		done: !!arg.done, 
	}
	f(res)
  })
  console.log('RPC-stream (Keys.SignStream)...')
  return (req?: SignInput, end?: boolean) => {
    ipcRenderer.send('rpc-stream', {service: 'Keys', method: 'SignStream', args: req, reply: reply, end: end})
    if (end) {
      ipcRenderer.removeAllListeners(reply)
    }
  }
}

export const verify = (req: VerifyRequest) => {
	return new Promise<VerifyResponse>((resolve, reject) => {
		const reply = 'Keys.Verify-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Verify):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Verify) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Verify)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Verify', args: req, reply: reply})
	})
}

export type VerifyFileEvent = {err?: {message: string; name: string; code?: number}, res?: VerifyFileOutput, done: boolean}

export const verifyFile = (
  f: (res: VerifyFileEvent) => void
): ((req?: VerifyFileInput, end?: boolean) => void) => {
  const reply = 'Keys.VerifyFile-' + replyID()
  ipcRenderer.on(reply, (event, arg) => {
    if (!!arg.done || arg.err) {
      ipcRenderer.removeAllListeners(reply)
	}
	if (arg.err) {
	  console.error('RPC-stream error (Keys.VerifyFile):', arg.err)
      errHandler(arg.err)
    }
    if (!!arg.done) {
      console.log('RPC-stream (Keys.VerifyFile) done')
	}
	const res: VerifyFileEvent = {		
		res: arg.resp,
		err: arg.err,
		done: !!arg.done, 
	}
	f(res)
  })
  console.log('RPC-stream (Keys.VerifyFile)...')
  return (req?: VerifyFileInput, end?: boolean) => {
    ipcRenderer.send('rpc-stream', {service: 'Keys', method: 'VerifyFile', args: req, reply: reply, end: end})
    if (end) {
      ipcRenderer.removeAllListeners(reply)
    }
  }
}

export type VerifyStreamEvent = {err?: {message: string; name: string; code?: number}, res?: VerifyOutput, done: boolean}

export const verifyStream = (
  f: (res: VerifyStreamEvent) => void
): ((req?: VerifyInput, end?: boolean) => void) => {
  const reply = 'Keys.VerifyStream-' + replyID()
  ipcRenderer.on(reply, (event, arg) => {
    if (!!arg.done || arg.err) {
      ipcRenderer.removeAllListeners(reply)
	}
	if (arg.err) {
	  console.error('RPC-stream error (Keys.VerifyStream):', arg.err)
      errHandler(arg.err)
    }
    if (!!arg.done) {
      console.log('RPC-stream (Keys.VerifyStream) done')
	}
	const res: VerifyStreamEvent = {		
		res: arg.resp,
		err: arg.err,
		done: !!arg.done, 
	}
	f(res)
  })
  console.log('RPC-stream (Keys.VerifyStream)...')
  return (req?: VerifyInput, end?: boolean) => {
    ipcRenderer.send('rpc-stream', {service: 'Keys', method: 'VerifyStream', args: req, reply: reply, end: end})
    if (end) {
      ipcRenderer.removeAllListeners(reply)
    }
  }
}

export const verifyDetached = (req: VerifyDetachedRequest) => {
	return new Promise<VerifyDetachedResponse>((resolve, reject) => {
		const reply = 'Keys.VerifyDetached-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.VerifyDetached):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.VerifyDetached) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.VerifyDetached)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'VerifyDetached', args: req, reply: reply})
	})
}

export const verifyDetachedFile = (req: VerifyDetachedFileInput) => {
	return new Promise<VerifyDetachedResponse>((resolve, reject) => {
		const reply = 'Keys.VerifyDetachedFile-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.VerifyDetachedFile):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.VerifyDetachedFile) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.VerifyDetachedFile)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'VerifyDetachedFile', args: req, reply: reply})
	})
}

export const verifyDetachedStream = (req: VerifyDetachedInput) => {
	return new Promise<VerifyDetachedResponse>((resolve, reject) => {
		const reply = 'Keys.VerifyDetachedStream-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.VerifyDetachedStream):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.VerifyDetachedStream) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.VerifyDetachedStream)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'VerifyDetachedStream', args: req, reply: reply})
	})
}

export const encrypt = (req: EncryptRequest) => {
	return new Promise<EncryptResponse>((resolve, reject) => {
		const reply = 'Keys.Encrypt-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Encrypt):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Encrypt) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Encrypt)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Encrypt', args: req, reply: reply})
	})
}

export type EncryptStreamEvent = {err?: {message: string; name: string; code?: number}, res?: EncryptOutput, done: boolean}

export const encryptStream = (
  f: (res: EncryptStreamEvent) => void
): ((req?: EncryptInput, end?: boolean) => void) => {
  const reply = 'Keys.EncryptStream-' + replyID()
  ipcRenderer.on(reply, (event, arg) => {
    if (!!arg.done || arg.err) {
      ipcRenderer.removeAllListeners(reply)
	}
	if (arg.err) {
	  console.error('RPC-stream error (Keys.EncryptStream):', arg.err)
      errHandler(arg.err)
    }
    if (!!arg.done) {
      console.log('RPC-stream (Keys.EncryptStream) done')
	}
	const res: EncryptStreamEvent = {		
		res: arg.resp,
		err: arg.err,
		done: !!arg.done, 
	}
	f(res)
  })
  console.log('RPC-stream (Keys.EncryptStream)...')
  return (req?: EncryptInput, end?: boolean) => {
    ipcRenderer.send('rpc-stream', {service: 'Keys', method: 'EncryptStream', args: req, reply: reply, end: end})
    if (end) {
      ipcRenderer.removeAllListeners(reply)
    }
  }
}

export type EncryptFileEvent = {err?: {message: string; name: string; code?: number}, res?: EncryptFileOutput, done: boolean}

export const encryptFile = (
  f: (res: EncryptFileEvent) => void
): ((req?: EncryptFileInput, end?: boolean) => void) => {
  const reply = 'Keys.EncryptFile-' + replyID()
  ipcRenderer.on(reply, (event, arg) => {
    if (!!arg.done || arg.err) {
      ipcRenderer.removeAllListeners(reply)
	}
	if (arg.err) {
	  console.error('RPC-stream error (Keys.EncryptFile):', arg.err)
      errHandler(arg.err)
    }
    if (!!arg.done) {
      console.log('RPC-stream (Keys.EncryptFile) done')
	}
	const res: EncryptFileEvent = {		
		res: arg.resp,
		err: arg.err,
		done: !!arg.done, 
	}
	f(res)
  })
  console.log('RPC-stream (Keys.EncryptFile)...')
  return (req?: EncryptFileInput, end?: boolean) => {
    ipcRenderer.send('rpc-stream', {service: 'Keys', method: 'EncryptFile', args: req, reply: reply, end: end})
    if (end) {
      ipcRenderer.removeAllListeners(reply)
    }
  }
}

export const decrypt = (req: DecryptRequest) => {
	return new Promise<DecryptResponse>((resolve, reject) => {
		const reply = 'Keys.Decrypt-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Decrypt):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Decrypt) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Decrypt)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Decrypt', args: req, reply: reply})
	})
}

export type DecryptStreamEvent = {err?: {message: string; name: string; code?: number}, res?: DecryptOutput, done: boolean}

export const decryptStream = (
  f: (res: DecryptStreamEvent) => void
): ((req?: DecryptInput, end?: boolean) => void) => {
  const reply = 'Keys.DecryptStream-' + replyID()
  ipcRenderer.on(reply, (event, arg) => {
    if (!!arg.done || arg.err) {
      ipcRenderer.removeAllListeners(reply)
	}
	if (arg.err) {
	  console.error('RPC-stream error (Keys.DecryptStream):', arg.err)
      errHandler(arg.err)
    }
    if (!!arg.done) {
      console.log('RPC-stream (Keys.DecryptStream) done')
	}
	const res: DecryptStreamEvent = {		
		res: arg.resp,
		err: arg.err,
		done: !!arg.done, 
	}
	f(res)
  })
  console.log('RPC-stream (Keys.DecryptStream)...')
  return (req?: DecryptInput, end?: boolean) => {
    ipcRenderer.send('rpc-stream', {service: 'Keys', method: 'DecryptStream', args: req, reply: reply, end: end})
    if (end) {
      ipcRenderer.removeAllListeners(reply)
    }
  }
}

export type DecryptFileEvent = {err?: {message: string; name: string; code?: number}, res?: DecryptFileOutput, done: boolean}

export const decryptFile = (
  f: (res: DecryptFileEvent) => void
): ((req?: DecryptFileInput, end?: boolean) => void) => {
  const reply = 'Keys.DecryptFile-' + replyID()
  ipcRenderer.on(reply, (event, arg) => {
    if (!!arg.done || arg.err) {
      ipcRenderer.removeAllListeners(reply)
	}
	if (arg.err) {
	  console.error('RPC-stream error (Keys.DecryptFile):', arg.err)
      errHandler(arg.err)
    }
    if (!!arg.done) {
      console.log('RPC-stream (Keys.DecryptFile) done')
	}
	const res: DecryptFileEvent = {		
		res: arg.resp,
		err: arg.err,
		done: !!arg.done, 
	}
	f(res)
  })
  console.log('RPC-stream (Keys.DecryptFile)...')
  return (req?: DecryptFileInput, end?: boolean) => {
    ipcRenderer.send('rpc-stream', {service: 'Keys', method: 'DecryptFile', args: req, reply: reply, end: end})
    if (end) {
      ipcRenderer.removeAllListeners(reply)
    }
  }
}

export const sigchain = (req: SigchainRequest) => {
	return new Promise<SigchainResponse>((resolve, reject) => {
		const reply = 'Keys.Sigchain-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Sigchain):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Sigchain) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Sigchain)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Sigchain', args: req, reply: reply})
	})
}

export const statement = (req: StatementRequest) => {
	return new Promise<StatementResponse>((resolve, reject) => {
		const reply = 'Keys.Statement-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Statement):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Statement) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Statement)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Statement', args: req, reply: reply})
	})
}

export const statementCreate = (req: StatementCreateRequest) => {
	return new Promise<StatementCreateResponse>((resolve, reject) => {
		const reply = 'Keys.StatementCreate-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.StatementCreate):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.StatementCreate) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.StatementCreate)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'StatementCreate', args: req, reply: reply})
	})
}

export const statementRevoke = (req: StatementRevokeRequest) => {
	return new Promise<StatementRevokeResponse>((resolve, reject) => {
		const reply = 'Keys.StatementRevoke-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.StatementRevoke):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.StatementRevoke) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.StatementRevoke)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'StatementRevoke', args: req, reply: reply})
	})
}

export const user = (req: UserRequest) => {
	return new Promise<UserResponse>((resolve, reject) => {
		const reply = 'Keys.User-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.User):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.User) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.User)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'User', args: req, reply: reply})
	})
}

export const userSearch = (req: UserSearchRequest) => {
	return new Promise<UserSearchResponse>((resolve, reject) => {
		const reply = 'Keys.UserSearch-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.UserSearch):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.UserSearch) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.UserSearch)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'UserSearch', args: req, reply: reply})
	})
}

export const userService = (req: UserServiceRequest) => {
	return new Promise<UserServiceResponse>((resolve, reject) => {
		const reply = 'Keys.UserService-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.UserService):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.UserService) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.UserService)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'UserService', args: req, reply: reply})
	})
}

export const userSign = (req: UserSignRequest) => {
	return new Promise<UserSignResponse>((resolve, reject) => {
		const reply = 'Keys.UserSign-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.UserSign):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.UserSign) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.UserSign)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'UserSign', args: req, reply: reply})
	})
}

export const userAdd = (req: UserAddRequest) => {
	return new Promise<UserAddResponse>((resolve, reject) => {
		const reply = 'Keys.UserAdd-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.UserAdd):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.UserAdd) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.UserAdd)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'UserAdd', args: req, reply: reply})
	})
}

export const search = (req: SearchRequest) => {
	return new Promise<SearchResponse>((resolve, reject) => {
		const reply = 'Keys.Search-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Search):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Search) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Search)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Search', args: req, reply: reply})
	})
}

export const secret = (req: SecretRequest) => {
	return new Promise<SecretResponse>((resolve, reject) => {
		const reply = 'Keys.Secret-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Secret):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Secret) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Secret)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Secret', args: req, reply: reply})
	})
}

export const secretSave = (req: SecretSaveRequest) => {
	return new Promise<SecretSaveResponse>((resolve, reject) => {
		const reply = 'Keys.SecretSave-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.SecretSave):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.SecretSave) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.SecretSave)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'SecretSave', args: req, reply: reply})
	})
}

export const secretRemove = (req: SecretRemoveRequest) => {
	return new Promise<SecretRemoveResponse>((resolve, reject) => {
		const reply = 'Keys.SecretRemove-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.SecretRemove):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.SecretRemove) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.SecretRemove)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'SecretRemove', args: req, reply: reply})
	})
}

export const secrets = (req: SecretsRequest) => {
	return new Promise<SecretsResponse>((resolve, reject) => {
		const reply = 'Keys.Secrets-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Secrets):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Secrets) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Secrets)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Secrets', args: req, reply: reply})
	})
}

export const item = (req: ItemRequest) => {
	return new Promise<ItemResponse>((resolve, reject) => {
		const reply = 'Keys.Item-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Item):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Item) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Item)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Item', args: req, reply: reply})
	})
}

export const items = (req: ItemsRequest) => {
	return new Promise<ItemsResponse>((resolve, reject) => {
		const reply = 'Keys.Items-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Items):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Items) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Items)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Items', args: req, reply: reply})
	})
}

export const pull = (req: PullRequest) => {
	return new Promise<PullResponse>((resolve, reject) => {
		const reply = 'Keys.Pull-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Pull):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Pull) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Pull)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Pull', args: req, reply: reply})
	})
}

export const push = (req: PushRequest) => {
	return new Promise<PushResponse>((resolve, reject) => {
		const reply = 'Keys.Push-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Push):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Push) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Push)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Push', args: req, reply: reply})
	})
}

export type WormholeEvent = {err?: {message: string; name: string; code?: number}, res?: WormholeOutput, done: boolean}

export const wormhole = (
  f: (res: WormholeEvent) => void
): ((req?: WormholeInput, end?: boolean) => void) => {
  const reply = 'Keys.Wormhole-' + replyID()
  ipcRenderer.on(reply, (event, arg) => {
    if (!!arg.done || arg.err) {
      ipcRenderer.removeAllListeners(reply)
	}
	if (arg.err) {
	  console.error('RPC-stream error (Keys.Wormhole):', arg.err)
      errHandler(arg.err)
    }
    if (!!arg.done) {
      console.log('RPC-stream (Keys.Wormhole) done')
	}
	const res: WormholeEvent = {		
		res: arg.resp,
		err: arg.err,
		done: !!arg.done, 
	}
	f(res)
  })
  console.log('RPC-stream (Keys.Wormhole)...')
  return (req?: WormholeInput, end?: boolean) => {
    ipcRenderer.send('rpc-stream', {service: 'Keys', method: 'Wormhole', args: req, reply: reply, end: end})
    if (end) {
      ipcRenderer.removeAllListeners(reply)
    }
  }
}

export const authSetup = (req: AuthSetupRequest) => {
	return new Promise<AuthSetupResponse>((resolve, reject) => {
		const reply = 'Keys.AuthSetup-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.AuthSetup):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.AuthSetup) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.AuthSetup)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'AuthSetup', args: req, reply: reply})
	})
}

export const authVault = (req: AuthVaultRequest) => {
	return new Promise<AuthVaultResponse>((resolve, reject) => {
		const reply = 'Keys.AuthVault-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.AuthVault):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.AuthVault) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.AuthVault)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'AuthVault', args: req, reply: reply})
	})
}

export const authUnlock = (req: AuthUnlockRequest) => {
	return new Promise<AuthUnlockResponse>((resolve, reject) => {
		const reply = 'Keys.AuthUnlock-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.AuthUnlock):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.AuthUnlock) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.AuthUnlock)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'AuthUnlock', args: req, reply: reply})
	})
}

export const authLock = (req: AuthLockRequest) => {
	return new Promise<AuthLockResponse>((resolve, reject) => {
		const reply = 'Keys.AuthLock-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.AuthLock):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.AuthLock) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.AuthLock)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'AuthLock', args: req, reply: reply})
	})
}

export const runtimeStatus = (req: RuntimeStatusRequest) => {
	return new Promise<RuntimeStatusResponse>((resolve, reject) => {
		const reply = 'Keys.RuntimeStatus-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.RuntimeStatus):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.RuntimeStatus) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.RuntimeStatus)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'RuntimeStatus', args: req, reply: reply})
	})
}

export const rand = (req: RandRequest) => {
	return new Promise<RandResponse>((resolve, reject) => {
		const reply = 'Keys.Rand-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Rand):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Rand) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Rand)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Rand', args: req, reply: reply})
	})
}

export const randPassword = (req: RandPasswordRequest) => {
	return new Promise<RandPasswordResponse>((resolve, reject) => {
		const reply = 'Keys.RandPassword-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.RandPassword):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.RandPassword) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.RandPassword)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'RandPassword', args: req, reply: reply})
	})
}

export const authProvision = (req: AuthProvisionRequest) => {
	return new Promise<AuthProvisionResponse>((resolve, reject) => {
		const reply = 'Keys.AuthProvision-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.AuthProvision):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.AuthProvision) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.AuthProvision)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'AuthProvision', args: req, reply: reply})
	})
}

export const authDeprovision = (req: AuthDeprovisionRequest) => {
	return new Promise<AuthDeprovisionResponse>((resolve, reject) => {
		const reply = 'Keys.AuthDeprovision-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.AuthDeprovision):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.AuthDeprovision) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.AuthDeprovision)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'AuthDeprovision', args: req, reply: reply})
	})
}

export const authProvisions = (req: AuthProvisionsRequest) => {
	return new Promise<AuthProvisionsResponse>((resolve, reject) => {
		const reply = 'Keys.AuthProvisions-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.AuthProvisions):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.AuthProvisions) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.AuthProvisions)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'AuthProvisions', args: req, reply: reply})
	})
}

export const passwordChange = (req: PasswordChangeRequest) => {
	return new Promise<PasswordChangeResponse>((resolve, reject) => {
		const reply = 'Keys.PasswordChange-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.PasswordChange):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.PasswordChange) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.PasswordChange)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'PasswordChange', args: req, reply: reply})
	})
}

export const vaultAuth = (req: VaultAuthRequest) => {
	return new Promise<VaultAuthResponse>((resolve, reject) => {
		const reply = 'Keys.VaultAuth-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.VaultAuth):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.VaultAuth) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.VaultAuth)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'VaultAuth', args: req, reply: reply})
	})
}

export const vaultSync = (req: VaultSyncRequest) => {
	return new Promise<VaultSyncResponse>((resolve, reject) => {
		const reply = 'Keys.VaultSync-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.VaultSync):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.VaultSync) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.VaultSync)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'VaultSync', args: req, reply: reply})
	})
}

export const vaultUnsync = (req: VaultUnsyncRequest) => {
	return new Promise<VaultUnsyncResponse>((resolve, reject) => {
		const reply = 'Keys.VaultUnsync-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.VaultUnsync):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.VaultUnsync) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.VaultUnsync)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'VaultUnsync', args: req, reply: reply})
	})
}

export const vaultStatus = (req: VaultStatusRequest) => {
	return new Promise<VaultStatusResponse>((resolve, reject) => {
		const reply = 'Keys.VaultStatus-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.VaultStatus):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.VaultStatus) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.VaultStatus)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'VaultStatus', args: req, reply: reply})
	})
}

export const vaultUpdate = (req: VaultUpdateRequest) => {
	return new Promise<VaultUpdateResponse>((resolve, reject) => {
		const reply = 'Keys.VaultUpdate-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.VaultUpdate):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.VaultUpdate) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.VaultUpdate)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'VaultUpdate', args: req, reply: reply})
	})
}

export const collections = (req: CollectionsRequest) => {
	return new Promise<CollectionsResponse>((resolve, reject) => {
		const reply = 'Keys.Collections-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Collections):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Collections) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Collections)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Collections', args: req, reply: reply})
	})
}

export const documents = (req: DocumentsRequest) => {
	return new Promise<DocumentsResponse>((resolve, reject) => {
		const reply = 'Keys.Documents-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Documents):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Documents) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Documents)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Documents', args: req, reply: reply})
	})
}

export const documentDelete = (req: DocumentDeleteRequest) => {
	return new Promise<DocumentDeleteResponse>((resolve, reject) => {
		const reply = 'Keys.DocumentDelete-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.DocumentDelete):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.DocumentDelete) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.DocumentDelete)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'DocumentDelete', args: req, reply: reply})
	})
}

export const adminSignURL = (req: AdminSignURLRequest) => {
	return new Promise<AdminSignURLResponse>((resolve, reject) => {
		const reply = 'Keys.AdminSignURL-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.AdminSignURL):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.AdminSignURL) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.AdminSignURL)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'AdminSignURL', args: req, reply: reply})
	})
}

export const adminCheck = (req: AdminCheckRequest) => {
	return new Promise<AdminCheckResponse>((resolve, reject) => {
		const reply = 'Keys.AdminCheck-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.AdminCheck):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.AdminCheck) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.AdminCheck)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'AdminCheck', args: req, reply: reply})
	})
}

export const messagePrepare = (req: MessagePrepareRequest) => {
	return new Promise<MessagePrepareResponse>((resolve, reject) => {
		const reply = 'Keys.MessagePrepare-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.MessagePrepare):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.MessagePrepare) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.MessagePrepare)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'MessagePrepare', args: req, reply: reply})
	})
}

export const messageCreate = (req: MessageCreateRequest) => {
	return new Promise<MessageCreateResponse>((resolve, reject) => {
		const reply = 'Keys.MessageCreate-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.MessageCreate):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.MessageCreate) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.MessageCreate)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'MessageCreate', args: req, reply: reply})
	})
}

export const messages = (req: MessagesRequest) => {
	return new Promise<MessagesResponse>((resolve, reject) => {
		const reply = 'Keys.Messages-' + replyID()
		ipcRenderer.on(reply, (event, arg) => {
			ipcRenderer.removeAllListeners(reply)
			if (arg.err) {
				console.error('RPC error (Keys.Messages):', arg.err)
				reject(arg.err)
				errHandler(arg.err)
			} else {
				console.log('RPC (Keys.Messages) done')
			}
			resolve(arg.resp)
		})
		console.log('RPC (Keys.Messages)...')
		ipcRenderer.send('rpc', {service: 'Keys', method: 'Messages', args: req, reply: reply})
	})
}

